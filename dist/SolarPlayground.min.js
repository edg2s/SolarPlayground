/*! SolarPlayground 07-29-2014 */
!function(){var a={container:{elements:{}},data:{items:{}},calc:{},view:{},ui:{ext:{}}};a.log=function(a,b){a=a||"LOG",window.console.log("["+a+"] "+b)},window.sp=a}(),window.requestNextAnimationFrame=function(){var a=void 0,b=void 0,c=0,d=navigator.userAgent,e=0,f=this;return window.webkitRequestAnimationFrame&&(b=function(a){void 0===a&&(a+=new Date),f.callback(a)},a=window.webkitRequestAnimationFrame,window.webkitRequestAnimationFrame=function(c,d){f.callback=c,a(b,d)}),window.mozRequestAnimationFrame&&(e=d.indexOf("rv:"),-1!=d.indexOf("Gecko")&&(c=d.substr(e+3,3),"2.0"===c&&(window.mozRequestAnimationFrame=void 0))),window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){var b,c;window.setTimeout(function(){b+=new Date,a(b),c+=new Date,f.timeout=1e3/60-(c-b)},f.timeout)}}(),sp.System=function(a){var b;OO.EventEmitter.call(this),this.containers={},a=a||{},b={scenario_dir:"scenarios",scenario_prefix:"scenario.",directory_sep:"/",width:$(window).width()-100,height:$(window).height()-100},this.config=$.extend(!0,b,a)},OO.mixinClass(sp.System,OO.EventEmitter),sp.System.prototype.setContainer=function(a,b){if(!a)throw Error("sp.System.setContainer must supply a valid container_id.");return this.containers[a]=new sp.container.Manager({container:"#"+a,width:b.width||this.config.width,height:b.height||this.config.height,gui:b.gui||"ooui",scenario_dir:this.config.scenario_dir,directory_sep:this.config.directory_sep,scenario_prefix:b.scenario_prefix||this.config.scenario_prefix,buildMode:!1}),this.containers[a]},sp.System.prototype.getContainer=function(a){if(!this.containers)throw Error("Cannot get container, no containers are defined.");return this.containers[a]},sp.System.prototype.getConfig=function(a){return this.config&&a?this.config[a]:this.config},sp.calc.Calculator=function(){},sp.calc.Calculator.constants={AU:149597871,G:6.67*Math.pow(10,-11)},sp.calc.Calculator.translateTime=function(a,b,c,d){var e;return a=a||2014,b=b||6,c=c||10,d=d||0,e=367*a-7*Math.floor((a+Math.floor((b+9)/12))/4)+275*Math.floor(b/9)+D-730530,e+=d/24},sp.calc.Calculator.getCenturies=function(a,b,c,d,e){var f,g=hour+e/60+second/3600;return c=c||1,b=b||1,f=367*a-7*Math.floor((a+Math.floor((b+9)/12))/4)+c-730531.5+g/24,f/36525},sp.calc.Calculator.getJDNTime=function(a,b,c,d,e,f){var g,h=Math.floor((14-b)/12),i=a+4800-h,j=b+12*h-3;return d=d||12,e=e||0,f=f||0,g=c+Math.floor((153*j+2)/5)+365*i+Math.floor(i/4)-Math.floor(i/100)+Math.floor(i/400)+32045,JD=g+(d-12)/24+e/1440+f/86400,JD-2451545},sp.calc.Calculator.solveKepler=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p={},q=1e3,r=Math.pow(10,-4),s=function(a){return a*(180/Math.PI)},t=function(a,b){for(var c=Math.PI/180*a,d=b+c+Math.sin(s(b)),e=1;q--&&Math.abs(e)>r;)dM=b-(d-c*Math.sin(s(d))),e=dM/(1-a*Math.cos(s(d))),d+=e;return s(d)};return a?(c=b||0,l=a.b||0,m=a.c||0,n=a.f||0,o=a.s||0,d=a.a[0]+a.a[1]*c,e=a.e[0]+a.e[1]*c,f=a.I[0]+a.I[1]*c,g=a.L[0]+a.L[1]*c,h=a.long_peri[0]+a.long_peri[1]*c,i=a.long_node[0]+a.long_node[1]*c,j=h-i,k=a.M||g-h+l*Math.pow(c,2)+m*Math.cos(n*c)+o*Math.sin(n*c),k=s(k)%180,E=t(e,k),x=d*(Math.cos(E)-e),y=d*Math.sqrt(1-Math.pow(e,2))*Math.sin(E),z=0,p={x:x,y:y,z:y}):null},sp.container.Loader=function(a){OO.EventEmitter.call(this),this.config=a||{}},OO.mixinClass(sp.container.Loader,OO.EventEmitter),sp.container.Loader.prototype.loadFromFile=function(a,b){var c=$.Deferred();return $.getJSON(b).done($.proxy(function(a){c.resolve(a)},this)).fail(function(){sp.log("Error","Scenario "+targetName+' not found in directory "'+targetDir+'"'),c.reject()}),c},sp.container.Loader.prototype.loadFromObject=function(a){var b;a=a||{},scenario=new sp.data.Scenario(this,a),this.setScenario(scenario),b=this.scenario.getAllObjects();for(o in b)this.gui.addToPOVList(o,b[o].getName());this.emit("scenarioLoaded",this.scenario)},sp.container.Manager=function(a){OO.EventEmitter.call(this),this.config=a||{},this.scenario=null,this.loader=new sp.container.Loader(a),this.$container=$(a.container).addClass("sp-container"),a.height-=40,this.screen=new sp.container.Screen(a),this.$container.append(this.screen.$canvas),guiLoader=new sp.ui.Loader({module:a.gui||"ooui",container:this}),this.gui=guiLoader.initialize()},OO.mixinClass(sp.container.Manager,OO.EventEmitter),sp.container.Manager.prototype.loadFromFile=function(a,b){var c,d,e=$.Deferred(),f=this.config.scenario_prefix||"",g=this.config.scenario_dir+this.config.directory_sep;return e=$.Deferred(),a=a||"example",c=g+f+a+".json",this.loader.loadFromFile(a,c).done($.proxy(function(a){scenario=new sp.data.Scenario(this.screen,a,b),this.setScenario(scenario),d=this.scenario.getAllObjects();for(var c in d)this.gui.addToPOVList(c,d[c].getName());this.emit("scenarioLoaded"),e.resolve(this)},this)),e},sp.container.Manager.prototype.addToolbar=function(a,b){b=b||"top","top"===b?this.$container.prepend(a):this.$container.append(a)},sp.container.Manager.prototype.setScenario=function(a){this.scenario=a,this.screen.clear(),this.scenario.draw()},sp.container.Manager.prototype.getScenario=function(){return this.scenario},sp.container.Manager.prototype.togglePaused=function(a){this.isPaused()!==a&&this.scenario.togglePaused(a)},sp.container.Manager.prototype.isPaused=function(){return this.scenario.isPaused()},sp.container.Manager.prototype.setZoom=function(a){this.scenario.getZoom()!==a&&this.scenario.setZoom(a)},sp.container.Manager.prototype.setPitchAngle=function(a){this.scenario&&this.scenario.setPitchAngle(a)},sp.container.Manager.prototype.execute=function(a,b){var c,d;if(this.enabled)return sp.ui.actionFactory.doesActionSupportMethod(a,b)?(c=sp.ui.actionFactory.create(a,this),d=c[b].apply(c,Array.prototype.slice.call(arguments,2)),void 0===d||!!d):!1},sp.container.Manager.prototype.addCommands=function(a){var b,c,d,e;for(b=0,c=a.length;c>b;b++){if(d=sp.ui.commandRegistry.lookup(a[b]),!d)throw new Error("No command registered by that name: "+a[b]);this.emit("addCommand",a[b],d,e)}},sp.container.Screen=function(a){this.config=a||{},OO.EventEmitter.call(this),this.canvasCenterPoint={x:0,y:0},this.$canvas=$("<canvas>").addClass("sp-container-canvas").attr("width",this.config.width).attr("height",this.config.height),this.context=this.$canvas[0].getContext("2d"),this.$canvas.on("mousedown",$.proxy(this.onCanvasMouseDown,this)),this.$canvas.on("mousemove",$.proxy(this.onCanvasMouseMove,this)),this.$canvas.on("mouseup",$.proxy(this.onCanvasMouseUp,this)),this.$canvas.on("mouseout",$.proxy(this.onCanvasMouseUp,this))},OO.mixinClass(sp.container.Screen,OO.EventEmitter),sp.container.Screen.prototype.onCanvasMouseDown=function(a){this.canvasMouseMoving=!0,this.mouseStartingPoint={x:a.pageX,y:a.pageY},this.emit("drag","start",this.mouseStartingPoint)},sp.container.Screen.prototype.onCanvasMouseMove=function(a){var b;this.canvasMouseMoving&&!$.isEmptyObject(this.mouseStartingPoint)&&(dx=a.pageX-this.mouseStartingPoint.x,dy=a.pageY-this.mouseStartingPoint.y,b={x:dx+this.canvasCenterPoint.x,y:dy+this.canvasCenterPoint.y},this.emit("drag","during",b))},sp.container.Screen.prototype.onCanvasMouseUp=function(){this.canvasMouseMoving=!1,this.mouseStartingPoint={},this.canvasCenterPoint={},this.emit("drag","end")},sp.container.Screen.prototype.drawCircle=function(a,b,c,d){this.context.save(),this.context.beginPath(),this.context.arc(a.x,a.y,b||5,0,2*Math.PI,!1),this.context.fillStyle=c||"white",d&&(this.context.shadowColor=c||"white",this.context.shadowBlur=20,this.context.shadowOffsetX=0,this.context.shadowOffsetY=0),this.context.fill(),this.context.restore()},sp.container.Screen.prototype.drawLine=function(a,b,c,d,e){this.context.beginPath(),this.context.moveTo(a[0],a[1]),this.context.lineTo(b[0],b[1]),e&&this.context.setLineDash&&this.context.setLineDash([5,7]),this.context.lineWidth=d||1,this.context.strokeStyle=c||"#ffffff",this.context.stroke()},sp.container.Screen.prototype.clear=function(a){var b=this.getDimensions();a=a||{},a.left=a.left||0,a.top=a.top||0,a.width=a.width||b.width,a.height=a.height||b.height,this.context.clearRect(a.left,a.top,a.width,a.height)},sp.container.Screen.prototype.setCenterPoint=function(a){this.canvasCenterPoint={x:a.x,y:a.y}},sp.container.Screen.prototype.getCenterPoint=function(){return this.canvasCenterPoint},sp.container.Screen.prototype.getContext=function(){return this.$canvas[0].getContext("2d")},sp.container.Screen.prototype.getDimensions=function(){return{width:this.$canvas.width(),height:this.$canvas.height()}},sp.data.CelestialBody=function(a){a=a||{},OO.EventEmitter.call(this),this.cache={},this.trails=[],this.frameCounter=0,this.trailsFrameGap=2,this.numTrailPoints=80,this.name=a.name||"",this.description=a.description||"",this.view=a.graphic||{},this.transform={x:0,y:0,angle:0,scale:1},this.vars=a.vars,this.initial_position=a.initial_position||{x:0,y:0},this.orbiting=null,this.type=a.type||"planet",this.radius=Number(a.vars.r)||10},OO.mixinClass(sp.data.CelestialBody,OO.EventEmitter),sp.data.CelestialBody.prototype.getSpaceCoordinates=function(b){var c,d,e;if(b=b||0,this.orbiting){if(this.vars.p||(a=this.vars.a[0],d=sp.calc.Calculator.constants.G,c=this.orbiting.getMass(),this.vars.p=2*Math.PI*Math.sqrt(Math.pow(a,3)/(d*c))),!(this.vars.a&&this.vars.e&&this.vars.I&&this.vars.L&&this.vars.long_peri&&this.vars.long_node))return this.vars.p&&this.vars.r?(this.coordinates={x:0,y:0,z:0},this.coordinates):(this.coordinates={x:0,y:0,z:0},this.coordinates);this.coordinates=sp.calc.Calculator.solveKepler(this.vars,b),e=this.orbiting.getSpaceCoordinates(b),e&&(this.coordinates={x:this.coordinates.x+e.x,y:this.coordinates.y+e.y,z:this.coordinates.z+e.z})}else this.coordinates={x:0,y:0,z:0};return this.coordinates},sp.data.CelestialBody.prototype.storeTrailPoint=function(a){this.trails.push(a),this.trails.length>this.numTrailPoints&&this.trails.shift()},sp.data.CelestialBody.prototype.getTrailPoints=function(){return this.trails},sp.data.CelestialBody.prototype.flushTrailPoints=function(){this.trails=[],this.frameCounter=0},sp.data.CelestialBody.prototype.getType=function(){return this.type},sp.data.CelestialBody.prototype.getName=function(){return this.name},sp.data.CelestialBody.prototype.getDescription=function(){return this.description},sp.data.CelestialBody.prototype.setOrbit=function(a){this.orbiting=a},sp.data.CelestialBody.prototype.getOrbit=function(){return this.orbiting},sp.data.CelestialBody.prototype.setName=function(a){this.name=a},sp.data.CelestialBody.prototype.setDescription=function(a){this.description=a},sp.data.CelestialBody.prototype.getMass=function(){return this.vars.m},sp.data.CelestialBody.prototype.getView=function(){return this.view},sp.data.CelestialBody.prototype.getRadius=function(){return this.vars.r},sp.data.Scenario=function(a,b,c){var d,e=Math.PI/180;OO.EventEmitter.call(this),c=c||{},this.screen=a,this.paused=!0,this.objects={},this.config=$.extend({},b.config,c),d=this.screen.getDimensions(),this.viewConverter=new sp.view.Converter({zoom:this.config.init_zoom||1,canvasDimensions:d,yaw:this.config.init_yaw*e||0,pitch:this.config.init_pitch*e||0,scale:{orbit:this.config.orbit_scale||.5*Math.pow(10,-5),planets:this.config.planet_scale}}),this.grid=new sp.view.Grid(this.screen,this.viewConverter),this.showTrails=this.config.show_trails||!1,this.showGrid=this.config.show_grid||!1,this.frameCounter=0,this.trailsFrameGap=5,this.pov_key=this.config.init_pov,this.pov_object=null,this.date=this.config.start_time||{day:1,month:1,year:2e3},this.time=0,this.speed=this.config.init_speed||1,this.processObjects(b.objects||{}),this.screen.connect(this,{drag:"onScreenDrag"}),this.viewConverter.connect(this,{pitch:"onPitchChange"})},OO.mixinClass(sp.data.Scenario,OO.EventEmitter),sp.data.Scenario.prototype.onScreenDrag=function(a,b){"start"===a?this.screen.setCenterPoint(this.getCenterPoint()):"during"===a?(this.setCenterPoint({x:b.x,y:b.y}),this.flushAllTrails(),this.screen.clear(),this.draw()):"end"===a&&this.screen.setCenterPoint(this.getCenterPoint())},sp.data.Scenario.prototype.onPitchChange=function(a){this.emit("pitch",a)},sp.data.Scenario.prototype.processObjects=function(a){var b,c,d={star:[],planet:[]};for(b in a)this.objects[b]=new sp.data.CelestialBody(a[b]),a[b].vars.r&&("star"===a[b].type?d.star.push(Number(a[b].vars.r)):d.planet.push(Number(a[b].vars.r)));this.viewConverter.setRadiiList(d);for(c in this.objects)a[c]&&this.objects[a[c].orbiting]&&this.objects[c].setOrbit(this.objects[a[c].orbiting]);this.pov_key&&this.objects[this.pov_key]&&(this.pov_object=this.objects[this.pov_key],this.viewConverter.setPOV(this.objects[this.pov_key].getSpaceCoordinates(0)))},sp.data.Scenario.prototype.setPOV=function(a){a&&this.objects[a]&&this.pov_key!==a&&(this.pov_key=a,this.pov_object=this.objects[this.pov_key],this.viewConverter.setPOV(this.objects[this.pov_key].getSpaceCoordinates(0)),this.screen.clear(),this.flushAllTrails(),this.draw(),this.emit("pov",this.pov_key))},sp.data.Scenario.prototype.getPOV=function(){return this.pov_key},sp.data.Scenario.prototype.draw=function(a,b){var c,d,e,f,g,h;a=a||this.time,this.showGrid&&this.grid.draw();for(c in this.objects)if(d=this.objects[c].getSpaceCoordinates(a),c===this.pov_key&&this.viewConverter.setPOV(d),f=this.objects[c].getView(),e=this.viewConverter.getCoordinates(d),e&&(g=this.viewConverter.getRadius(this.objects[c].getRadius(),this.objects[c].getType()),this.screen.drawCircle(e,g,f.color,"star"===this.objects[c].getType())),!b&&this.showTrails&&c!==this.pov_key)for(this.frameCounter++,this.frameCounter>=this.trailsFrameGap&&(this.objects[c].storeTrailPoint(e),this.frameCounter=0),h=this.objects[c].getTrailPoints(),i=0;i<h.length;i++)h[i]&&this.screen.drawCircle(h[i],1,f.color||"#FF005D")},sp.data.Scenario.prototype.flushAllTrails=function(){var a;for(a in this.objects)this.objects[a].flushTrailPoints()},sp.data.Scenario.prototype.run=function(){this.paused||(this.screen.clear(),this.draw(this.time),this.time+=1e-10*this.speed,window.requestNextAnimationFrame($.proxy(this.run,this)))},sp.data.Scenario.prototype.getAllObjects=function(){return this.objects},sp.data.Scenario.prototype.togglePaused=function(a){void 0===a&&(a=!this.paused),a=!!a,this.paused=a,this.run(),this.emit("pause",this.paused)},sp.data.Scenario.prototype.isPaused=function(){return this.paused},sp.data.Scenario.prototype.pause=function(){this.togglePaused(!0)},sp.data.Scenario.prototype.resume=function(){this.togglePaused(!1),this.run()},sp.data.Scenario.prototype.toggleGrid=function(a){void 0===a&&(a=!this.showGrid),a=!!a,this.showGrid=a,this.screen.clear(),this.draw(this.time),this.emit("grid",this.showGrid)},sp.data.Scenario.prototype.isShowGrid=function(){return this.showGrid},sp.data.Scenario.prototype.setZoom=function(a){this.viewConverter.setZoom(a),this.flushAllTrails(),this.isPaused()&&(this.screen.clear(),this.draw(this.time,!0)),this.emit("zoom",a)},sp.data.Scenario.prototype.getZoom=function(){return this.viewConverter.getZoom()},sp.data.Scenario.prototype.setCenterPoint=function(a){this.viewConverter.setCenterPoint(a),this.flushAllTrails(),this.isPaused()&&(this.screen.clear(),this.draw(this.time,!0))},sp.data.Scenario.prototype.getCenterPoint=function(){return this.viewConverter.getCenterPoint()},sp.data.Scenario.prototype.addToCenterPoint=function(a,b){this.viewConverter.addToCenterPoint(a,b)},sp.data.Scenario.prototype.setPitchAngle=function(a){this.viewConverter.setPitchAngle(a),this.flushAllTrails(),this.isPaused()&&(this.screen.clear(),this.draw(this.time,!0))},sp.data.Scenario.prototype.getPitchAngle=function(){return this.viewConverter.getPitchAngle()},sp.view.Converter=function(a){OO.EventEmitter.call(this),this.config=a||{},this.zoom=this.config.zoom||1,this.orbit_scale=this.config.orbit_scale||1,this.yaw=this.config.yaw,this.pitch=this.config.pitch,this.canvasDimensions=this.config.canvasDimensions||{width:0,height:0},this.scenarioCenterPoint={x:this.canvasDimensions.width/2,y:this.canvasDimensions.height/2},this.pov={x:0,y:0,z:0},this.radii_list=null,this.radii={star:[25,30,32,35],planet:[10,12,14,16],moon:[4,8,10,12]},this.radius_step={star:0,planet:0}},OO.mixinClass(sp.view.Converter,OO.EventEmitter),sp.view.Converter.prototype.setPOV=function(a){a&&(a.x!==this.pov.x||a.y!==this.pov.y)&&(this.pov=a,this.emit("changePOV",a))},sp.view.Converter.prototype.getCoordinates=function(a){var b=Math.cos(this.yaw),c=Math.sin(this.yaw),d=Math.cos(this.pitch),e=Math.sin(this.pitch),f=this.scenarioCenterPoint.x,g=this.scenarioCenterPoint.y,h=Math.sqrt(this.orbit_scale*this.zoom);return x=(a.x-this.pov.x)*h,y=(a.y-this.pov.y)*h,z=(a.z-this.pov.z)*h,destination={x:x*b-y*c+f,y:x*c+y*b},destination.z=destination.y*e,destination.y=destination.y*d+g,destination.x>0&&destination.x<=this.canvasDimensions.width&&destination.y>0&&destination.y<=this.canvasDimensions.height?destination:void 0},sp.view.Converter.prototype.setRadiiList=function(a){var b,c;this.radii_list=a;for(b in this.radii_list)this.radii_list[b].sort(function(a,b){return a-b}),c=this.radii_list[b][this.radii_list[b].length-1]-this.radii_list[b][0],this.radius_step[b]=c/this.radii[b].length},sp.view.Converter.prototype.getRadius=function(a,b){var c,d,e=this.radius_step[b]||1;return b=b||"planet",d=Math.floor(a/e),d>this.radii[b].length-1&&(d=this.radii[b].length-1),c=Math.sqrt(this.radii[b][d]*this.zoom)/100,c>=2?c:2},sp.view.Converter.prototype.setZoom=function(a){this.zoom+=a},sp.view.Converter.prototype.getZoom=function(){return this.zoom},sp.view.Converter.prototype.setCenterPoint=function(a){a=a||{},x=a.x||0,y=a.y||0,this.scenarioCenterPoint={x:x,y:y}},sp.view.Converter.prototype.getCenterPoint=function(){return this.scenarioCenterPoint},sp.view.Converter.prototype.addToCenterPoint=function(a,b){a=a||0,b=b||0,this.scenarioCenterPoint.x+=a,this.scenarioCenterPoint.y+=b},sp.view.Converter.prototype.setPitchAngle=function(a){this.pitch!==a&&(this.pitch=a,this.emit("pitch",this.pitch))},sp.view.Converter.prototype.getPitchAngle=function(){return this.pitch},sp.view.Grid=function(a,b,c){this.screen=a,this.viewConverter=b,this.config=c||{},this.color=this.config.grid_color||"#575757",this.spacing=this.config.spacing||{x:45,y:45}},sp.view.Grid.prototype.draw=function(){var a,b=(Math.PI/180,0),c=this.screen.getDimensions(),e=(this.screen.getContext(),this.viewConverter.getCenterPoint()),f=this.viewConverter.getPitchAngle();for(a=f>Math.PI/4?c.height/2*Math.tan(f):f>0&&f<Math.PI/4?c.height/2*Math.tan(Math.PI/4-f):0,H=c.height/2-a,d=H*Math.tan(f),topEdge=e.y-H,bottomEdge=e.y+H,this.screen.drawLine([0,topEdge],[c.width,topEdge],this.color,1,!1),this.screen.drawLine([0,bottomEdge],[c.width,bottomEdge],this.color,1,!1),this.screen.drawLine([0,e.y],[c.width,e.y],this.color,1,!1),b=0,gridPoint=e.y;gridPoint-this.spacing.x>topEdge;)gridPoint=e.y-this.spacing.x*b,this.screen.drawLine([0,gridPoint],[c.width,gridPoint],this.color,1,!1),b++;for(b=0,gridPoint=e.y;gridPoint+this.spacing.x<bottomEdge;)gridPoint=e.y+this.spacing.x*b,this.screen.drawLine([0,gridPoint],[c.width,gridPoint],this.color,1,!1),b++;for(originGridPointTop=e.x+d,originGridPointBottom=e.x-d,this.screen.drawLine([e.x+d,topEdge],[e.x-d,bottomEdge],this.color,1,!1),gridPointTop=originGridPointTop,gridPointBottom=originGridPointBottom;gridPointTop>0&&gridPointTop<c.width||gridPointBottom>0&&gridPointBottom<c.width;)gridPointTop+=this.spacing.y,gridPointBottom+=this.spacing.y,this.screen.drawLine([gridPointTop,topEdge],[gridPointBottom,bottomEdge],this.color,1,!1);for(gridPointTop=originGridPointTop,gridPointBottom=originGridPointBottom;gridPointTop>0&&gridPointTop<c.width||gridPointBottom>0&&gridPointBottom<c.width;)gridPointTop-=this.spacing.y,gridPointBottom-=this.spacing.y,this.screen.drawLine([gridPointTop,topEdge],[gridPointBottom,bottomEdge],this.color,1,!1)},sp.view.Grid.prototype.getCenterPoint=function(){return this.viewConverter.getCenterPoint()},sp.ui.Command=function(a,b,c){this.name=a,this.action=b,this.method=c,this.data=Array.prototype.slice.call(arguments,3)},sp.ui.Command.prototype.execute=function(a){return a.execute.apply(a,[this.action,this.method].concat(this.data))},sp.ui.Command.prototype.getAction=function(){return this.action},sp.ui.Command.prototype.getMethod=function(){return this.method},sp.ui.Command.prototype.getName=function(){return this.name},sp.ui.Command.prototype.getData=function(){return this.data},sp.ui.CommandRegistry=function(){OO.Registry.call(this)},OO.inheritClass(sp.ui.CommandRegistry,OO.Registry),sp.ui.CommandRegistry.prototype.register=function(a){if(!(a instanceof sp.ui.Command))throw new Error("command must be an instance of sp.ui.Command, cannot be a "+typeof a);OO.Registry.prototype.register.call(this,a.getName(),a)},sp.ui.commandRegistry=new sp.ui.CommandRegistry,sp.ui.commandRegistry.register(new sp.ui.Command("play","playTools","play")),sp.ui.Loader=function(a){a=a||{},OO.EventEmitter.call(this),this.moduleName=a.module||"ooui",this.module=null,this.scenario=a.scenario,this.settings=a.settings||{},this.container=a.container,this.$spinner=$("<div>").addClass("sp-system-spinner").appendTo(this.container.$container)},OO.mixinClass(sp.ui.Loader,OO.EventEmitter),sp.ui.Loader.prototype.initialize=function(){var a;switch(this.$spinner.show(),this.moduleName){case"jqueryui":this.module=new sp.ui.ext.jqueryui.Mod.Play(this.container,this.settings);break;case"ooui":default:this.module=new sp.ui.ext.ooui.Mod.Play(this.container,this.settings)}return a=this.module.initialize(this.settings),this.$spinner.hide(),a},sp.ui.ext.Play=function(a,b){b=b||{},OO.EventEmitter.call(this),this.container=a},OO.mixinClass(sp.ui.ext.Play,OO.EventEmitter),sp.ui.ext.Play.prototype.initialize=function(){throw new Error("sp.Gui.Module.Initialize must be implemented in child class.")},sp.ui.ext.Play.prototype.addToPOVList=function(){throw new Error("sp.Gui.Module.addToPOVList must be implemented in child class.")},sp.ui.ext.StatusBar=function(a,b){b=b||{},OO.EventEmitter.call(this),this.container=a},OO.mixinClass(sp.ui.ext.StatusBar,OO.EventEmitter),sp.ui.ext.StatusBar.prototype.initialize=function(){throw new Error("sp.Gui.Module.Initialize must be implemented in child class.")},sp.ui.ext.ooui={Mod:{}},sp.ui.toolFactory=new OO.ui.ToolFactory,sp.ui.toolGroupFactory=new OO.ui.ToolGroupFactory,sp.ui.ext.ooui.Mod.Play=function(a,b){return b=b||{},sp.ui.ext.ooui.Mod.Play.super.call(this,a,b),this.tools={},this.container=a,this},OO.inheritClass(sp.ui.ext.ooui.Mod.Play,sp.ui.ext.Play),sp.ui.ext.ooui.Mod.Play.static.toolbarGroups=[{type:"bar",include:[{group:"playTools"}],exclude:["pause"]},{type:"menu",indicator:"down",label:"POV",icon:"picture",include:[{group:"povTools"}]},{type:"bar",include:[{group:"zoomTools"}]},{type:"bar",include:[{group:"viewTools"}],exclude:["speed"]}],sp.ui.ext.ooui.Mod.Play.static.commands=["play","speed","zoomin","zoomout"],sp.ui.ext.ooui.Mod.Play.prototype.initialize=function(){return this.toolbar=new sp.ui.ext.ooui.Toolbar(this,this.container),this.toolbar.setup(this.constructor.static.toolbarGroups),this.container.addToolbar(this.toolbar.$element),this.toolbar.emit("updateState"),this.container.connect(this,{scenarioLoaded:"onScenarioLoaded"}),this},sp.ui.ext.ooui.Mod.Play.prototype.onScenarioLoaded=function(){this.container.getScenario()&&this.container.getScenario().disconnect(this),this.container.getScenario().connect(this,{pause:["onScenarioChanged","play"]}),this.container.getScenario().connect(this,{pov:["onScenarioChanged","pov"]}),this.container.getScenario().connect(this,{grid:["onScenarioChanged","grid"]}),this.toolbar.emit("updateState")},sp.ui.ext.ooui.Mod.Play.prototype.onScenarioChanged=function(){this.toolbar.emit("updateState",arguments)},sp.ui.ext.ooui.Mod.Play.prototype.addToPOVList=function(a,b,c){var d,e;c=c||"picture",e=[a,c,b],d=this.createPOVTool.apply(this,e),sp.ui.toolFactory.register(d)},sp.ui.ext.ooui.Mod.Play.prototype.getToolbar=function(){return this.toolbar},sp.ui.ext.ooui.Mod.Play.prototype.createPOVTool=function(a,b,c){var d=function(){d.super.apply(this,arguments)};return OO.inheritClass(d,sp.ui.ext.ooui.POVTool),d.static.name=a,d.static.icon=b,d.static.title=c,d},sp.ui.ext.ooui.Toolbar=function(a,b,c){OO.ui.Toolbar.call(this,sp.ui.toolFactory,sp.ui.toolGroupFactory,c),this.target=a,this.container=b,this.container.connect(this,{addCommand:"onContainerAddCommand"})},OO.inheritClass(sp.ui.ext.ooui.Toolbar,OO.ui.Toolbar),sp.ui.ext.ooui.Toolbar.prototype.getContainer=function(){return this.container},sp.ui.ext.ooui.Toolbar.prototype.onContainerAddCommand=function(a){this.tools[a]&&this.tools[a].updateTitle()},sp.ui.ext.ooui.Toolbar.prototype.onMouseDown=function(){},sp.ui.ext.ooui.Tool=function(a,b){OO.ui.Tool.call(this,a,b)},OO.inheritClass(sp.ui.ext.ooui.Tool,OO.ui.Tool),sp.ui.ext.ooui.Tool.prototype.onUpdateState=function(){this.setDisabled(!this.toolbar.getContainer().getScenario())},sp.ui.ext.ooui.Tool.prototype.onSelect=function(){this.constructor.static.deactivateOnSelect&&this.setActive(!1)},sp.ui.ext.ooui.PlayTool=function(a,b){sp.ui.ext.ooui.Tool.call(this,a,b)},OO.inheritClass(sp.ui.ext.ooui.PlayTool,sp.ui.ext.ooui.Tool),sp.ui.ext.ooui.PlayTool.static.name="play",sp.ui.ext.ooui.PlayTool.static.group="playTools",sp.ui.ext.ooui.PlayTool.static.icon="play",sp.ui.ext.ooui.PlayTool.static.title="Play",sp.ui.ext.ooui.PlayTool.static.commandName="play",sp.ui.ext.ooui.PlayTool.prototype.onUpdateState=function(){sp.ui.ext.ooui.Tool.prototype.onUpdateState.apply(this,arguments),this.toolbar.getContainer().getScenario()&&this.setActive(!this.toolbar.getContainer().getScenario().isPaused())},sp.ui.ext.ooui.PlayTool.prototype.onSelect=function(){this.toolbar.getContainer().getScenario().togglePaused()},sp.ui.toolFactory.register(sp.ui.ext.ooui.PlayTool),sp.ui.ext.ooui.PauseTool=function(a,b){sp.ui.ext.ooui.Tool.call(this,a,b)},OO.inheritClass(sp.ui.ext.ooui.PauseTool,sp.ui.ext.ooui.Tool),sp.ui.ext.ooui.PauseTool.static.name="pause",sp.ui.ext.ooui.PauseTool.static.group="playTools",sp.ui.ext.ooui.PauseTool.static.icon="pause",sp.ui.ext.ooui.PauseTool.static.title="pause",sp.ui.ext.ooui.PauseTool.static.commandName="pause",sp.ui.ext.ooui.PauseTool.prototype.onUpdateState=function(){sp.ui.ext.ooui.Tool.prototype.onUpdateState.apply(this,arguments),this.toolbar.getContainer().getScenario()&&this.setActive(this.toolbar.getContainer().getScenario().isPaused())},sp.ui.ext.ooui.PauseTool.prototype.onSelect=function(){this.toolbar.getContainer().getScenario().togglePaused()},sp.ui.toolFactory.register(sp.ui.ext.ooui.PauseTool),sp.ui.ext.ooui.ZoomTool=function(a,b){sp.ui.ext.ooui.Tool.call(this,a,b)},OO.inheritClass(sp.ui.ext.ooui.ZoomTool,sp.ui.ext.ooui.Tool),sp.ui.ext.ooui.ZoomTool.static.group="zoomTools",sp.ui.ext.ooui.ZoomTool.static.deactivateOnSelect=!0,sp.ui.ext.ooui.ZoomTool.prototype.onUpdateState=function(){sp.ui.ext.ooui.Tool.prototype.onUpdateState.apply(this,arguments),this.setDisabled(!this.toolbar.getContainer().getScenario())},sp.ui.ext.ooui.ZoomTool.prototype.onSelect=function(a){this.toolbar.getContainer().getScenario().setZoom(a),sp.ui.ext.ooui.Tool.prototype.onSelect.call(this)},sp.ui.ext.ooui.ZoomInTool=function(a,b){sp.ui.ext.ooui.ZoomTool.call(this,a,b)},OO.inheritClass(sp.ui.ext.ooui.ZoomInTool,sp.ui.ext.ooui.ZoomTool),sp.ui.ext.ooui.ZoomInTool.static.name="zoomin",sp.ui.ext.ooui.ZoomInTool.static.icon="zoomin",sp.ui.ext.ooui.ZoomInTool.static.title="Zoom in",sp.ui.ext.ooui.ZoomInTool.static.commandName="zoomin",sp.ui.ext.ooui.ZoomInTool.prototype.onSelect=function(){sp.ui.ext.ooui.ZoomTool.prototype.onSelect.apply(this,[1e3])},sp.ui.toolFactory.register(sp.ui.ext.ooui.ZoomInTool),sp.ui.ext.ooui.ZoomOutTool=function(a,b){sp.ui.ext.ooui.ZoomTool.call(this,a,b)},OO.inheritClass(sp.ui.ext.ooui.ZoomOutTool,sp.ui.ext.ooui.ZoomTool),sp.ui.ext.ooui.ZoomOutTool.static.name="zoomout",sp.ui.ext.ooui.ZoomOutTool.static.icon="zoomout",sp.ui.ext.ooui.ZoomOutTool.static.title="Zoom out",sp.ui.ext.ooui.ZoomOutTool.static.commandName="zoomout",sp.ui.ext.ooui.ZoomOutTool.prototype.onSelect=function(){sp.ui.ext.ooui.ZoomTool.prototype.onSelect.apply(this,[-1e3])},sp.ui.toolFactory.register(sp.ui.ext.ooui.ZoomOutTool),sp.ui.ext.ooui.GridTool=function(a,b){sp.ui.ext.ooui.Tool.call(this,a,b)},OO.inheritClass(sp.ui.ext.ooui.GridTool,sp.ui.ext.ooui.Tool),sp.ui.ext.ooui.GridTool.static.name="grid",sp.ui.ext.ooui.GridTool.static.group="viewTools",sp.ui.ext.ooui.GridTool.static.icon="grid",sp.ui.ext.ooui.GridTool.static.title="grid",sp.ui.ext.ooui.GridTool.static.commandName="grid",sp.ui.ext.ooui.GridTool.prototype.onUpdateState=function(){sp.ui.ext.ooui.Tool.prototype.onUpdateState.apply(this,arguments),this.toolbar.getContainer().getScenario()&&this.setActive(this.toolbar.getContainer().getScenario().isShowGrid())},sp.ui.ext.ooui.GridTool.prototype.onSelect=function(){this.toolbar.getContainer().getScenario().toggleGrid()},sp.ui.toolFactory.register(sp.ui.ext.ooui.GridTool),sp.ui.ext.ooui.PitchTool=function(a,b){sp.ui.ext.ooui.Tool.call(this,a,b)},OO.inheritClass(sp.ui.ext.ooui.PitchTool,sp.ui.ext.ooui.Tool),sp.ui.ext.ooui.PitchTool.static.group="viewTools",sp.ui.ext.ooui.PitchTool.static.deactivateOnSelect=!0,sp.ui.ext.ooui.PitchTool.prototype.onUpdateState=function(){sp.ui.ext.ooui.Tool.prototype.onUpdateState.apply(this,arguments),this.setDisabled(!this.toolbar.getContainer().getScenario())},sp.ui.ext.ooui.PitchTool.prototype.onSelect=function(){var a=180/Math.PI,b=Math.PI/180,c=this.toolbar.getContainer().getScenario();pitch=Math.floor(c.getPitchAngle()*a),pitch+=this.constructor.static.changeAngle,this.toolbar.getContainer().getScenario().setPitchAngle(pitch*b),sp.ui.ext.ooui.Tool.prototype.onSelect.call(this)},sp.ui.ext.ooui.TiltUpTool=function(a,b){sp.ui.ext.ooui.PitchTool.call(this,a,b)},OO.inheritClass(sp.ui.ext.ooui.TiltUpTool,sp.ui.ext.ooui.PitchTool),sp.ui.ext.ooui.TiltUpTool.static.name="tiltup",sp.ui.ext.ooui.TiltUpTool.static.icon="tiltup",sp.ui.ext.ooui.TiltUpTool.static.title="Tilt up",sp.ui.ext.ooui.TiltUpTool.static.changeAngle=10,sp.ui.ext.ooui.TiltUpTool.static.commandName="tiltup",sp.ui.toolFactory.register(sp.ui.ext.ooui.TiltUpTool),sp.ui.ext.ooui.TiltDownTool=function(a,b){sp.ui.ext.ooui.PitchTool.call(this,a,b)},OO.inheritClass(sp.ui.ext.ooui.TiltDownTool,sp.ui.ext.ooui.PitchTool),sp.ui.ext.ooui.TiltDownTool.static.name="tiltdown",sp.ui.ext.ooui.TiltDownTool.static.icon="tiltdown",sp.ui.ext.ooui.TiltDownTool.static.title="Tilt down",sp.ui.ext.ooui.TiltDownTool.static.changeAngle=-10,sp.ui.ext.ooui.TiltDownTool.static.commandName="tiltdown",sp.ui.toolFactory.register(sp.ui.ext.ooui.TiltDownTool),sp.ui.ext.ooui.LabelTool=function(a,b){OO.ui.Tool.call(this,a,b),OO.ui.LabeledElement.call(this,$("<div>"),b),this.$element.empty(),this.$element.append(this.$label.show())},OO.inheritClass(sp.ui.ext.ooui.LabelTool,OO.ui.Tool),OO.mixinClass(sp.ui.ext.ooui.LabelTool,OO.ui.LabeledElement),sp.ui.ext.ooui.LabelTool.prototype.onUpdateState=function(){this.setDisabled(!this.toolbar.getContainer().getScenario())},sp.ui.ext.ooui.ZoomLabelTool=function(a,b){sp.ui.ext.ooui.LabelTool.call(this,a,b)},OO.inheritClass(sp.ui.ext.ooui.ZoomLabelTool,sp.ui.ext.ooui.LabelTool),sp.ui.ext.ooui.ZoomLabelTool.static.name="zoomLabel",sp.ui.ext.ooui.ZoomLabelTool.static.group="zoomTools",sp.ui.ext.ooui.ZoomLabelTool.static.title="Zoom",sp.ui.ext.ooui.ZoomLabelTool.prototype.onUpdateState=function(){sp.ui.ext.ooui.LabelTool.prototype.onUpdateState.apply(this,arguments),this.toolbar.getContainer().getScenario()&&this.setLabel(this.toolbar.getContainer().getScenario().getZoom())},sp.ui.ext.ooui.ZoomLabelTool.prototype.onSelect=function(){return!1},sp.ui.toolFactory.register(sp.ui.ext.ooui.ZoomLabelTool),sp.ui.ext.ooui.POVTool=function(a,b){OO.ui.Tool.call(this,a,b)},OO.inheritClass(sp.ui.ext.ooui.POVTool,OO.ui.Tool),sp.ui.ext.ooui.POVTool.static.group="povTools",sp.ui.ext.ooui.POVTool.prototype.onUpdateState=function(){var a;
this.setDisabled(!this.toolbar.getContainer().getScenario()),this.toolbar.getContainer().getScenario()&&(a=this.toolbar.getContainer().getScenario().getPOV(),this.setActive(a===this.constructor.static.name))},sp.ui.ext.ooui.POVTool.prototype.onSelect=function(){this.toolbar.getContainer().getScenario()&&this.toolbar.getContainer().getScenario().setPOV(this.constructor.static.name)},sp.ui.ext.ooui.SliderTool=function(a,b){sp.ui.ext.ooui.Tool.call(this,a,b),this.$element.empty(),this.$slider=this.$("<input>").addClass("sp-ui-ooui-sliderHandle").attr("type","range").attr("min","1").attr("max","100"),this.$element.addClass("sp-ui-ooui-sliderTool").append(this.$slider)},OO.inheritClass(sp.ui.ext.ooui.SliderTool,sp.ui.ext.ooui.Tool),sp.ui.ext.ooui.SliderTool.prototype.onUpdateState=function(){sp.ui.ext.ooui.Tool.prototype.onUpdateState.apply(this,arguments)},sp.ui.ext.ooui.SpeedSliderTool=function(a,b){sp.ui.ext.ooui.SliderTool.call(this,a,b),this.$element.addClass("sp-ui-ooui-speedSlider")},OO.inheritClass(sp.ui.ext.ooui.SpeedSliderTool,sp.ui.ext.ooui.Tool),sp.ui.ext.ooui.SpeedSliderTool.static.name="speed",sp.ui.ext.ooui.SpeedSliderTool.static.group="viewTools",sp.ui.ext.ooui.SpeedSliderTool.static.icon="speed",sp.ui.ext.ooui.SpeedSliderTool.static.title="speed",sp.ui.ext.ooui.SpeedSliderTool.static.commandName="speed",sp.ui.toolFactory.register(sp.ui.ext.ooui.SpeedSliderTool),sp.ui.ext.jqueryui={Mod:{}},sp.ui.ext.jqueryui.Mod.Play=function(a,b){b=b||{},sp.ui.ext.jqueryui.Mod.Play.super.call(this,a,b),this.buttonSets={},this.buttons={},this.statusBar=new sp.ui.ext.jqueryui.Mod.StatusBar(a,b),this.container.connect(this,{scenarioLoaded:"onScenarioLoaded"})},OO.inheritClass(sp.ui.ext.jqueryui.Mod.Play,sp.ui.ext.Play),sp.ui.ext.jqueryui.Mod.Play.prototype.initialize=function(){var a=$("<div>").addClass("sp-ui-jqueryui-sep");return this.$toolbar=$("<div>").addClass("sp-ui-jqueryui-toolbar"),this.buttonSets={},this.buttons={},this.labels={},this.buttons.play=new sp.ui.ext.jqueryui.CheckButtonTool({name:"play",icon:"play"}),this.buttons.povList=new sp.ui.ext.jqueryui.SelectTool({name:"pov"}),this.buttons.zoomin=new sp.ui.ext.jqueryui.ClickButtonTool({name:"zoomin",icon:"zoomin",action:1e3}),this.buttons.zoomout=new sp.ui.ext.jqueryui.ClickButtonTool({name:"zoomout",icon:"zoomout",action:-1e3}),this.buttons.grid=new sp.ui.ext.jqueryui.CheckButtonTool({name:"grid",icon:"grid"}),this.$toolbar.append([this.buttons.play.$element,a.clone(),this.buttons.povList.$element,a.clone(),this.buttons.zoomin.$element,this.buttons.zoomout.$element,a.clone(),this.buttons.grid.$element]),this.container.addToolbar(this.$toolbar),this.labels.zoom=new sp.ui.ext.jqueryui.LabelTool({label:"Zoom level"}),this.statusBar.$element.append([this.labels.zoom.$element]),this.container.addToolbar(this.statusBar.$element,"bottom"),this.buttons.play.connect(this,{change:"onPlayChange"}),this.buttons.povList.connect(this,{change:"onPovChange"}),this.buttons.zoomin.connect(this,{click:"onZoomClick"}),this.buttons.zoomout.connect(this,{click:"onZoomClick"}),this.buttons.grid.connect(this,{change:"onGridChange"}),this},sp.ui.ext.jqueryui.Mod.Play.prototype.onScenarioLoaded=function(){this.container.getScenario()&&this.container.getScenario().disconnect(this),this.container.getScenario().connect(this,{pause:["onScenarioChanged","pause"]}),this.container.getScenario().connect(this,{pov:["onScenarioChanged","pov"]}),this.container.getScenario().connect(this,{grid:["onScenarioChanged","grid"]}),this.container.getScenario().connect(this,{zoom:["onScenarioChanged","zoom"]}),this.buttons.play.setValue(!this.container.getScenario().isPaused()),this.buttons.povList.setValue(this.container.getScenario().getPOV()),this.buttons.grid.setValue(this.container.getScenario().isShowGrid()),this.labels.zoom.setValue(this.container.getScenario().getZoom())},sp.ui.ext.jqueryui.Mod.Play.prototype.onScenarioChanged=function(a,b){switch(a){case"pause":this.buttons.play.setValue(!b);break;case"pov":this.buttons.povList.setValue(b);break;case"grid":this.buttons.grid.setValue(b);break;case"zoom":this.labels.zoom.setValue(this.container.getScenario().getZoom())}},sp.ui.ext.jqueryui.Mod.Play.prototype.onPlayChange=function(a){this.container.getScenario().togglePaused(!a)},sp.ui.ext.jqueryui.Mod.Play.prototype.onZoomClick=function(a){this.container.getScenario().setZoom(a)},sp.ui.ext.jqueryui.Mod.Play.prototype.onPovChange=function(a){this.container.getScenario().setPOV(a)},sp.ui.ext.jqueryui.Mod.Play.prototype.onGridChange=function(a){this.container.getScenario().toggleGrid(a)},sp.ui.ext.jqueryui.Mod.Play.prototype.addToPOVList=function(a,b){this.buttons.povList.addOption(a,b)},sp.ui.ext.jqueryui.Mod.StatusBar=function(a,b){$("<div>").addClass("sp-ui-jqueryui-sep");b=b||{},sp.ui.ext.jqueryui.Mod.StatusBar.super.call(this,a,b),this.$element=$("<div>").addClass("sp-ui-jqueryui-statusbar")},OO.inheritClass(sp.ui.ext.jqueryui.Mod.StatusBar,sp.ui.ext.StatusBar),sp.ui.ext.jqueryui.Buttonset=function(a){a=a||{},this.$element=$("<div>").addClass("sp-ui-jqueryui-toolset"),a.name&&this.$element.addClass("sp-ui-jqueryui-toolset-"+a.name),this.tools=a.tools||[],this.$element.buttonset()},sp.ui.ext.jqueryui.Buttonset.prototype.addButton=function(a){this.tools.push(a),this.$element.append(a.$element)},sp.ui.ext.jqueryui.ClickButtonTool=function(a){a=a||{},OO.EventEmitter.call(this),this.name=a.name||"general",this.action=a.action,this.$element=$("<button>").prop("id","sp-ui-jqueryui-tool-"+this.name).addClass("sp-ui-jqueryui-clickButtonTool"),a.icon&&this.$element.addClass("sp-ui-jqueryui-tool-icon sp-ui-jqueryui-icon-"+a.icon),a.label&&this.$element.text(a.label),this.$element.on("click",$.proxy(this.onClick,this)),this.$element.button()},OO.inheritClass(sp.ui.ext.jqueryui.ClickButtonTool,OO.EventEmitter),sp.ui.ext.jqueryui.ClickButtonTool.prototype.onClick=function(a){this.emit("click",this.action),a.preventDefault()},sp.ui.ext.jqueryui.CheckButtonTool=function(a){a=a||{},OO.EventEmitter.call(this),this.value=!1,this.name=a.name||"general",this.$checkbox=$("<input>").prop("type","checkbox").prop("id","sp-ui-jqueryui-tool-"+this.name).prop("checked",!1),this.$label=$("<label>").attr("for","sp-ui-jqueryui-tool-"+this.name),a.icon&&this.$label.addClass("sp-ui-jqueryui-tool-icon sp-ui-jqueryui-icon-"+a.icon),a.label&&this.$label.text(a.label),this.$element=$("<div>").addClass("sp-ui-jqueryui-tool sp-ui-jqueryui-tool-checkButtonTool").append([this.$checkbox,this.$label]),this.$checkbox.on("change",$.proxy(this.onChange,this)),this.$checkbox.button()},OO.inheritClass(sp.ui.ext.jqueryui.CheckButtonTool,OO.EventEmitter),sp.ui.ext.jqueryui.CheckButtonTool.prototype.onChange=function(a){var b=this.value;this.value=this.$checkbox.prop("checked"),this.value!==b&&this.emit("change",this.value),a.preventDefault()},sp.ui.ext.jqueryui.CheckButtonTool.prototype.getValue=function(){return this.value},sp.ui.ext.jqueryui.CheckButtonTool.prototype.setValue=function(a){this.value=!!a,this.$checkbox.prop("checked",this.value),this.$checkbox.button("refresh")},sp.ui.ext.jqueryui.LabelTool=function(a){a=a||{},this.$element=$("<div>").addClass("sp-ui-jqueryui-labelTool"),this.value=a.value,this.$label=$("<span>").addClass("sp-ui-jqueryui-labelTool-label").text(a.label+":").appendTo(this.$element),this.$value=$("<span>").addClass("sp-ui-jqueryui-labelTool-value").text(a.value).appendTo(this.$element)},sp.ui.ext.jqueryui.LabelTool.prototype.setValue=function(a){this.value=a,this.$value.text(a)},sp.ui.ext.jqueryui.LabelTool.prototype.getValue=function(){return this.value},sp.ui.ext.jqueryui.SelectTool=function(a){a=a||{},OO.EventEmitter.call(this),this.name=a.name||"general",this.action=a.action,this.$element=$("<select>").prop("id","sp-ui-jqueryui-tool-"+this.name).addClass("sp-ui-jqueryui-selectTool"),this.options={},this.value="",this.$element.on("change",$.proxy(this.onChange,this))},OO.inheritClass(sp.ui.ext.jqueryui.SelectTool,OO.EventEmitter),sp.ui.ext.jqueryui.SelectTool.prototype.onChange=function(){var a=this.value;this.value=this.$element.val(),this.value!==a&&this.emit("change",this.value)},sp.ui.ext.jqueryui.SelectTool.prototype.setValue=function(a){this.value!==a&&(this.value=a,this.$element.val(a))},sp.ui.ext.jqueryui.SelectTool.prototype.addOption=function(a,b){var c=$("<option>").attr("value",a).text(b);this.options[name]=a,this.$element.append(c)},sp.ui.ext.jqueryui.SelectTool.prototype.removeOption=function(a){this.options[a]&&(delete this.options[a],this.$element.find("option[value="+a+"]").remove())},sp.ui.ext.jqueryui.SelectTool.prototype.empty=function(){this.$element.empty()};